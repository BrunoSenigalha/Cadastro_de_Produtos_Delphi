unit uValidacaoCampos;

interface

  uses
     System.SysUtils, System.Classes, Vcl.StdCtrls, Vcl.Dialogs, System.Character,
     System.Generics.Collections;

function ValidarEntradaNumerica(var Key: Char): string;
function VerificaCampoVazio(const ListaCampos: TList<TEdit>): String;
function RetornaMensagemDeErro(const Campo: TEdit): String;

implementation

function ValidarEntradaNumerica(var Key: Char): string;
begin
  // Permitir teclas de controle como Backspace
   if CharInSet(Key, [#8]) then Exit;

  // Permitir apenas números (0 a 9)
  if not CharInSet(Key, ['0'..'9']) then
   begin
      Key := #0; //Cancela a entrada
      Result:= 'Insira apenas numeros';
   end;
end;

function VerificaCampoVazio(const ListaCampos: TList<TEdit>): String;
  var
  texto: string;
  Campo: TEdit;
  I: Integer;
begin
  for Campo in ListaCampos do
  begin
     texto:= Campo.Text;
     if texto.Trim.IsEmpty then
     begin

       Result:= RetornaMensagemDeErro(Campo);
       ListaCampos.Free;
       Exit;
     end;
  end;
end;

function RetornaMensagemDeErro(const Campo: TEdit): String;
var
  MsgErro: string;
  NomeCampo: string;

begin
  MsgErro:= 'O seguinte campo não pode ser vazio: ';

  if Campo.Name = 'ed_codbarras' then
    Result:= MsgErro + 'Código de Barras'

  else if Campo.Name = 'ed_descricao' then
    Result:= MsgErro + 'Descrição'

  else if Campo.Name = 'ed_grupo' then
    Result:= MsgErro + 'Grupo'

  else if Campo.Name = 'ed_marca' then
    Result:= MsgErro + 'Marca'

  else if Campo.Name = 'ed_preco' then
    Result:= MsgErro + 'Preço'

  else if Campo.Name = 'ed_quantidade' then
    Result:= MsgErro + 'Quantidade'

  else
    Result:= '';
end;
end.
